<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Secure Admin Panel ‚Äì Ja Ellrach</title>
  <style>
    body {
      font-family: 'JetBrains Mono', monospace;
      background: #000;
      color: #fff;
      margin: 0;
      padding: 2rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 2rem;
    }
    th, td {
      border: 1px solid #444;
      padding: 0.5rem;
      text-align: left;
    }
    th {
      background: #111;
    }
    select, button {
      padding: 0.3rem 0.6rem;
      background: #00f0ff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      color: #000;
      font-weight: bold;
    }
    button:hover {
      background: #00c0d6;
    }
    #loginBox {
      display: flex;
      flex-direction: column;
      max-width: 300px;
      margin: 5rem auto;
      background: #111;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 0 15px rgba(0,255,255,0.2);
    }
    #loginBox input {
      margin-bottom: 1rem;
      padding: 0.6rem;
      border: none;
      border-radius: 5px;
      background: #222;
      color: #fff;
    }
  </style>
</head>
<body>
  <div id="loginBox">
    <h2>Admin Login</h2>
    <input type="password" id="adminPass" placeholder="Enter Password" />
    <button onclick="checkLogin()">Access</button>
    <p id="loginError" style="color: red;"></p>
  </div>  <div id="adminPanel" style="display:none;">
    <h1>üìÅ Admin Panel ‚Äì Academic Requests</h1>
    <table id="dataTable">
      <thead>
        <tr>
          <th>#</th>
          <th>Timestamp</th>
          <th>Name</th>
          <th>Email</th>
          <th>Subject</th>
          <th>Message</th>
          <th>File</th>
          <th>Status</th>
          <th>Update</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>  <script>
    const adminPassword = "EllrachSecure0927"; // Change this password

    function checkLogin() {
      const entered = document.getElementById("adminPass").value;
      if (entered === adminPassword) {
        document.getElementById("loginBox").style.display = "none";
        document.getElementById("adminPanel").style.display = "block";
        loadData();
      } else {
        document.getElementById("loginError").textContent = "‚ùå Incorrect password.";
      }
    }

    function loadData() {
      const scriptURL = "https://script.google.com/macros/s/AKfycbz7FLgr-4DZxtVOvf2kW4bpZMhpyu63YCVZnRlQtsXSXtK_KyvY_0na_q7RYSoYJH3MQA/exec";
      fetch(scriptURL)
        .then(res => res.json())
        .then(data => {
          const tbody = document.querySelector("#dataTable tbody");
          tbody.innerHTML = "";
          data.forEach((entry, index) => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td>${index + 1}</td>
              <td>${entry.Timestamp || ''}</td>
              <td>${entry.Name || ''}</td>
              <td>${entry.Email || ''}</td>
              <td>${entry.Subject || ''}</td>
              <td>${entry.Message || ''}</td>
              <td>${entry["File URL"] ? `<a href="${entry["File URL"]}" target="_blank">Open</a>` : "No file"}</td>
              <td>
                <select id="status-${entry.rowIndex}">
                  <option value="Pending" ${entry.Status === "Pending" ? "selected" : ""}>Pending</option>
                  <option value="In Progress" ${entry.Status === "In Progress" ? "selected" : ""}>In Progress</option>
                  <option value="Done" ${entry.Status === "Done" ? "selected" : ""}>Done</option>
                  <option value="Rejected" ${entry.Status === "Rejected" ? "selected" : ""}>Rejected</option>
                </select>
              </td>
              <td><button onclick="updateStatus(${entry.rowIndex})">Update</button></td>
            `;
            tbody.appendChild(tr);
          });
        });
    }

    function updateStatus(rowIndex) {
      const newStatus = document.getElementById(`status-${rowIndex}`).value;
      const scriptURL = "https://script.google.com/macros/s/AKfycbz7FLgr-4DZxtVOvf2kW4bpZMhpyu63YCVZnRlQtsXSXtK_KyvY_0na_q7RYSoYJH3MQA/exec";

      fetch(scriptURL, {
        method: "PATCH",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ rowIndex, status: newStatus })
      })
      .then(res => res.text())
      .then(msg => alert("‚úÖ Status updated."))
      .catch(() => alert("‚ùå Failed to update status."));
    }
  </script></body>
</html>